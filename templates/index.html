<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'unsafe-inline'; style-src 'self' 'unsafe-inline'; img-src 'self' data:; font-src 'self' data:;">
    <title>Epic Game Story Generator - 3D UI</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
    <!-- 3D Background -->
    <div id="bg3d"></div>
    <canvas id="particles"></canvas>

    <div class="container">
        <div class="title">
            <h1>ğŸ® Epic Game Story Generator</h1>
            <p>Craft cinematic RPG stories with AI-powered characters, dialogues, and stunning visuals.</p>
        </div>

        <div class="glass-panel">
            <form id="storyForm">
                <!-- Story Parameters -->
                <div class="accordion">
                    <div class="accordion-header" onclick="toggleAccordion(this)">
                        <h3>âš™ï¸ Story Parameters</h3>
                        <span>â–¼</span>
                    </div>
                    <div class="accordion-content active">
                        <div class="form-group">
                            <label>ğŸ¤– Choose Gemini Model</label>
                            <select id="model" name="model">
                                <option value="gemini-1.5-flash">Gemini Flash (Fast & Efficient)</option>
                                <option value="gemini-1.5-pro">Gemini Pro (Most Powerful)</option>
                            </select>
                            <small style="opacity: 0.7; display: block; margin-top: 4px;">Note: Old model names are automatically mapped to the latest Gemini 2.x models</small>
                        </div>
                        <div class="form-group">
                            <label>ğŸ¨ Model Creativity</label>
                            <input type="range" id="temperature" name="temperature" min="0" max="1" step="0.1" value="0.8">
                            <span id="tempValue">0.8</span>
                        </div>
                        <div class="form-group">
                            <label>ğŸŒ Enter Game Genre</label>
                            <input type="text" id="genre" name="genre" value="Fantasy" placeholder="e.g., Fantasy, Sci-Fi, Adventure">
                        </div>
                        <div class="form-group">
                            <label>ğŸ“ Optional: Custom Story Prompt</label>
                            <textarea id="custom_prompt" name="custom_prompt" placeholder="Enter your story preferences, themes, or specific requirements (optional)..."></textarea>
                        </div>
                        <div class="form-group">
                            <label>ğŸ–¼ï¸ Number of Scenes</label>
                            <input type="number" id="num_images" name="num_images" min="1" max="10" value="5">
                        </div>
                    </div>
                </div>

                <!-- Character 1 -->
                <div class="accordion">
                    <div class="accordion-header" onclick="toggleAccordion(this)">
                        <h3>ğŸ‘¤ Character 1 Details</h3>
                        <span>â–¼</span>
                    </div>
                    <div class="accordion-content active">
                        <div class="form-group">
                            <label>Character 1 Name</label>
                            <input type="text" id="character1_name" name="character1_name" value="Hero" required>
                        </div>
                        <div class="form-group">
                            <label>ğŸ¨ Appearance</label>
                            <textarea id="character1_appearance" name="character1_appearance" placeholder="e.g., Tall warrior with blue armor and golden hair"></textarea>
                        </div>
                        <div class="form-group">
                            <label>ğŸš— Vehicle</label>
                            <input type="text" id="character1_vehicle" name="character1_vehicle" placeholder="e.g., Flying dragon mount">
                        </div>
                        <div class="form-group">
                            <label>âš”ï¸ Weapons</label>
                            <input type="text" id="character1_weapons" name="character1_weapons" placeholder="e.g., Legendary sword of light">
                        </div>
                    </div>
                </div>

                <!-- Character 2 -->
                <div class="accordion">
                    <div class="accordion-header" onclick="toggleAccordion(this)">
                        <h3>ğŸ‘¥ Character 2 Details</h3>
                        <span>â–¼</span>
                    </div>
                    <div class="accordion-content active">
                        <div class="form-group">
                            <label>Character 2 Name</label>
                            <input type="text" id="character2_name" name="character2_name" value="Mentor" required>
                        </div>
                        <div class="form-group">
                            <label>ğŸ¨ Appearance</label>
                            <textarea id="character2_appearance" name="character2_appearance" placeholder="e.g., Wise mage with flowing robes and staff"></textarea>
                        </div>
                        <div class="form-group">
                            <label>ğŸš— Vehicle</label>
                            <input type="text" id="character2_vehicle" name="character2_vehicle" placeholder="e.g., Magical floating disc">
                        </div>
                        <div class="form-group">
                            <label>âš”ï¸ Weapons</label>
                            <input type="text" id="character2_weapons" name="character2_weapons" placeholder="e.g., Ancient spell book and crystal orb">
                        </div>
                    </div>
                </div>

                <button type="submit" class="btn" id="generateBtn">ğŸš€ Generate Epic Story</button>
            </form>
        </div>

        <div class="error" id="errorMsg"></div>

        <div class="loading" id="loading">
            <div class="spinner"></div>
            <p>Generating your epic story with AI agents...</p>
        </div>

        <div class="output-section glass-panel" id="outputSection" style="display: none;">
            <h2>Your Generated Content</h2>
            <div class="tabs">
                <button class="tab active" onclick="switchTab('story', this)">ğŸ“– Story</button>
                <button class="tab" onclick="switchTab('images', this)">ğŸ–¼ï¸ Images</button>
            </div>

            <div id="storyTab" class="tab-content active">
                <div class="story-output" id="storyOutput"></div>
            </div>

            <div id="imagesTab" class="tab-content">
                <div class="gallery" id="imageGallery"></div>
            </div>
        </div>
    </div>

    <script src="{{ url_for('static', filename='script.js') }}"></script>
</body>
</html>
